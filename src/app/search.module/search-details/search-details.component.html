<div *ngIf="listing" fxLayout="row wrap">
    <div fxFlex="100" ngClass="mt-1">
        <h2>{{listing.location.name}}</h2>
        <div fxLayout="row" fxLayoutAlign="space-between center">
            <p>{{ 'host.listing.' + listing.location.listingTypeName | translate}} - {{ listing.location.countryName }}, {{ listing.location.locality }}</p>
            <button class="text-muted" mat-icon-button><mat-icon>favorite</mat-icon></button>
        </div>
    </div>

    <div fxFlex="100" fxShow="false" fxShow.gt-sm>
        <app-images [images]="images"></app-images>
        <app-images-loader *ngIf="loadingImages" ></app-images-loader>
    </div>

    <div fxFlex="100" fxShow="true" fxHide.gt-sm>
        <app-images-slider *ngIf="!loadingImages" [slides]="images"></app-images-slider>
        <ngx-skeleton-loader *ngIf="loadingImages" count="1" appearance="circle" [theme]="{
            width: '100%',
            height: '480px',
            'border-radius': '5px'
          }">
        </ngx-skeleton-loader> 
        <!-- <app-images-loader *ngIf="loadingImages" ></app-images-loader> -->
    </div>

    <div fxFlex="100">
        <div fxLayoutAlign="space-between center">
            <div>{{ 'search.office-types' | translate }}</div>
            <div>
                <a mat-flat-button [matMenuTriggerFor]="workingHours" #workingHoursTrigger="matMenuTrigger">
                    <mat-icon class="mat-icon-sm account-icon">info</mat-icon>
                    <span>{{ 'search.working-hours' | translate }}</span> 
                </a>
                <mat-menu #workingHours="matMenu" [overlapTrigger]="false" xPosition="before" class="top-menu-dropdown cart-dropdown">
                    <span (mouseleave)="workingHoursTrigger.closeMenu()">
                        <mat-list role="list">
                            <mat-list-item role="listitem"*ngFor="let hours of listing.hours.availableHours">{{ 'host.listing.' + hours.weekday | translate }}: {{ hours.fromHours }} - {{ hours.toHours }}</mat-list-item>
                        </mat-list>
                    </span>
                </mat-menu>  
            </div>
        </div>
        <div class="divider"></div>
        <form class="mat-table admin-table high-row" [formGroup]="spacesForm">
            <div class="mat-header-row">
                <div class="mat-header-cell">{{ 'search.office-type' | translate }}</div>
                <div class="mat-header-cell">{{ 'search.office-name' | translate }}</div> 
                <div class="mat-header-cell">{{ 'search.seats-no' | translate }}</div>
                <div class="mat-header-cell">{{ 'search.hourly-price' | translate }}</div>
                <div class="mat-header-cell">{{ 'search.daily-price' | translate }}</div>
                <div class="mat-header-cell"></div>
                <div class="mat-header-cell"></div>
                <div class="mat-header-cell"></div>
                <div class="mat-header-cell">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
            </div>
            <ng-container formArrayName="availableSpacesPrice">
                <div *ngFor="let spacePrice of availableSpacesPriceControls; let i=index" [formGroupName]="i" class="mat-row">
                    <div class="mat-cell" data-label="{{ 'search.office-type' | translate }}">{{ 'host.listing.' + spacePrice.controls.officeTypeCode.value | translate }}</div>
                    <div class="mat-cell" data-label="{{ 'search.office-name' | translate }}">{{ spacePrice.controls.availableSpaceName.value }}</div>
                    <div class="mat-cell" data-label="{{ 'search.seats-no' | translate }}">{{ ( listing.description.availableSpaces | filterById : spacePrice.controls.idAvailableSpace.value )?.seatsNo }} seats</div>
                    <div class="mat-cell" data-label="{{ 'search.hourly-price' | translate }}">{{ spacePrice.controls.hourlyPrice.value }} €/hour</div>    
                    <div class="mat-cell" data-label="{{ 'search.daily-price' | translate }}">{{ spacePrice.controls.dayPrice.value }} €/day</div>         
                    <div class="mat-cell">
                        <mat-form-field>
                            <input matInput type="number" placeholder="{{ 'search.units' | translate }}" formControlName="bookedUnitsNo">
                        </mat-form-field>
                    </div> 
                    <div class="mat-cell">
                        <mat-form-field>
                            <input matInput [ngxMatDatetimePicker]="pickerCheckin" placeholder="{{ 'search.checkin' | translate }}" formControlName="checkin"
                              [min]="minDateCheckin" [max]="maxDate" readonly>
                            <mat-datepicker-toggle matSuffix [for]="pickerCheckin"></mat-datepicker-toggle>
                            <ngx-mat-datetime-picker #pickerCheckin [defaultTime]="defaultTimeCheckin" [min]="minDateCheckin" [showSpinners]="true" [showSeconds]="false" [stepHour]="1"
                              [stepMinute]="30" [stepSecond]="stepSecond" [touchUi]="true" [color]="primary"
                              [enableMeridian]="false" [disableMinute]="false" [hideTime]="false">
                              <!-- Custom icon or text of Apply icon -->
                              <ng-template>
                                <!-- <mat-icon>star</mat-icon> -->
                                <span>OK</span>
                              </ng-template>
                            </ngx-mat-datetime-picker>
                        </mat-form-field>
                    </div>
                    <div class="mat-cell">
                        <mat-form-field>
                            <input matInput [ngxMatDatetimePicker]="pickerCheckout" placeholder="{{ 'search.checkout' | translate }}" formControlName="checkout"
                              [min]="minDateCheckout" [max]="maxDate" readonly>
                            <mat-datepicker-toggle matSuffix [for]="pickerCheckout"></mat-datepicker-toggle>
                            <ngx-mat-datetime-picker #pickerCheckout [defaultTime]="defaultTimeCheckout" [min]="minDateCheckout" [showSpinners]="true" [showSeconds]="false" [stepHour]="1"
                            [stepMinute]="30" [stepSecond]="stepSecond" [touchUi]="true" [color]="primary"
                            [enableMeridian]="false" [disableMinute]="false" [hideTime]="false">
                              <!-- Custom icon or text of Apply icon -->
                              <ng-template>
                                <!-- <mat-icon>star</mat-icon> -->
                                <span>OK</span>
                              </ng-template>
                            </ngx-mat-datetime-picker>
                        </mat-form-field>
                    </div>
                    <div class="mat-cell text-right">
                        <!-- <button *ngIf="!spacePrice.controls.isAvailable.value" mat-flat-button color="primary" [disabled]="!spacePrice.valid" type="button" (click)="checkAvailability(spacePrice.value)">Check Availability</button> -->
                        <span class="ml-1 mr-1 fw-500" *ngIf="spacePrice.controls.isAvailable.value == true && spacePrice.controls.bookedPrice.value > 0">{{ spacePrice.controls.bookedPrice.value }}€</span>
                        <span matTooltip="{{ 'search.unavailable' | translate }}" class="ml-1" *ngIf="spacePrice.controls.isAvailable.value == false && spacePrice.controls.bookedPrice.value == 0"><mat-icon class="mat-icon-lg" color="warn">warning</mat-icon></span>
                        <button mat-icon-button color="primary" type="button" 
                            matTooltip="{{ 'search.add-booking' | translate }}"
                            [disabled]="!spacePrice.valid || !spacePrice.controls.isAvailable.value" 
                            (click)="addToBookingList(spacePrice.value)">
                            <mat-icon class="mat-icon-lg">list_alt</mat-icon>
                        </button>
                        <button *ngIf="guard.authenticated" mat-icon-button type="button"
                            matTooltip="{{ 'search.direct-booking' | translate }}"
                            [disabled]="!spacePrice.valid || !spacePrice.controls.isAvailable.value" 
                            (click)="directBooking(spacePrice.value)">
                            <mat-icon class="mat-icon-lg">check</mat-icon>
                        </button>
                    </div>     
                </div>
            </ng-container>
        <!-- </div> -->
        </form>
    </div>
    
    <div fxLayout="column" fxLayout.gt-sm="row" fxFlex="100" fxLayoutAlign="space-between start" class="mt-3">
        <div fxFlex="100" fxFlex.gt-sm="40">
            <p>{{ 'search.description' | translate }}</p>
            <div class="divider mb-1"></div>
            <p class="py-1 text-muted lh">{{listing.description.description}}</p>
        </div>
        <div fxFlex="100" fxFlex.gt-sm="40">
            <p>{{ 'search.amenities' | translate }}</p>
            <div class="divider mb-1"></div>
            <mat-list role="list">
                <mat-list-item *ngFor="let amenity of listing.description.amenities" role="listitem" class="text-muted">{{ 'host.listing.' + amenity.code | translate }}</mat-list-item>
            </mat-list>
        </div>
    </div>
</div>






